{% extends "reports/report_base.html" %}

{% block report_content %}
<div class="container">
    <h2 id=>{{report.name}}</h2>

    <div class="input-group mb-3">
        <div class="input-group-prepend">
            <span class="input-group-text" id="inputGroup-sizing-default3">Keywords</span>
        </div>
        <input type="text" maxlength="50" class="form-control" aria-label="Default"
               aria-describedby="inputGroup-sizing-default" id="keyword" name="keyword" disabled
               value="{{report.keyword}}">
    </div>

    <div class="input-group mb-3">
        <div class="input-group-prepend">
            <span class="input-group-text" id="inputGroup-sizing-default4">Tweet Count</span>
        </div>
        <input type="text" maxlength="50" class="form-control" aria-label="Default"
               aria-describedby="inputGroup-sizing-default" id="count" name="count" disabled
               value="{{report.tweet_count}}">
    </div>
    <div class="input-group mb-3">
        <div class="input-group-prepend">
            <span class="input-group-text" id="inputGroup-sizing-default5">Time interval</span>
        </div>
        <input type="text" maxlength="50" class="form-control" aria-label="Default"
               aria-describedby="inputGroup-sizing-default" value="{{report.time_interval}}" disabled>
    </div>

    <div>
        <button class="btn-warning" id='button' type="button"><span class="fa fa-plus"></span>Show/Hide Tweets
        </button>
        <button class="btn-warning" id='button2' type="button"><span class="fa fa-plus"></span>Analyze Tweets
        </button>
    </div>
    <br>
    <p id="name">{{report.name}}</p>
    <br>
    <br>
    <br>
    <div class="input-group mb-3" id="datatable-div">
        <table id="datatable" class="display" style="width:100%">
            <thead>
            <tr>
                <th>Tweet ID</th>
                <th>Creation Date</th>
                <th>Tweet Text</th>
                <th>Category</th>
                <th>Sentiment</th>
                <th>Neutral</th>
                <th>Negative</th>
                <th>Positive</th>
                <th>Compound</th>
            </tr>
            </thead>
            <tfoot>
            <tr>
                <th>Tweet ID</th>
                <th>Creation Date</th>
                <th>Tweet Text</th>
                <th>Category</th>
                <th>Sentiment</th>
                <th>Neutral</th>
                <th>Negative</th>
                <th>Positive</th>
                <th>Compound</th>
            </tr>
            </tfoot>
        </table>
    </div>
</div>
</div>

<script>
    window.onload = function (e) {
        document.getElementById("datatable").style.visibility = 'hidden'
        document.getElementById("datatable-div").style.visibility = 'hidden'
        document.getElementById("name").style.visibility = 'hidden'
        //document.getElementById("button2").style.visibility = 'hidden'
    }

    tweets = {}
    name = document.getElementById("name").innerHTML
    $("#button").click(function () {

        if (tweets.count == undefined) {
            tweets = $.ajax({
                type: 'POST',
                async: false,
                url: '{% url "reports:get_tweets" %}',
                dataType: 'json',
                data: {
                    'name': name,
                }
            }).responseJSON;

            $('#datatable').DataTable({
                destroy: true,
                "processing": true,
                data: tweets['data']
            });
        }

        if (document.getElementById("datatable").style.visibility == 'hidden') {
            document.getElementById("datatable").style.visibility = 'visible'
            document.getElementById("datatable-div").style.visibility = 'visible'

        } else {
            document.getElementById("datatable").style.visibility = 'hidden'
            document.getElementById("datatable-div").style.visibility = 'hidden'
        }
    });


</script>
{% endblock %}
